{% extends "header.html" %}

{% block title %} Scanner {% endblock %}

{% block body %}
	<br>
	<table align="center" class="table-bordered table-striped">
		<thead>
			<tr>
				<th> Market </th>
				<th> Base Volume (24h) </th>
				<th> Bid </th>
				<th> Ask </th>
				<th> Last </th>
				<th> Previous Day </th>
				<th> % Change (24h) </th>
				<th> RSI </th>
			</tr>
		</thead>

		<tbody id="table-body" />
	</table>
{% endblock %}

{% block javascript %}
	<script type="text/javascript">

		var isRescan = false;

		(function update() {
			$.ajax({
				url: "{% url 'scan' %}",
				type: "GET",
				data: { isRescan },
				dataType: "json",
				success: function(response) {

					var rowData = response['table'];

					var rowHtml = "";

					for (i = 0; i < rowData.length; i++) {
						var row = rowData[i];

						rowHtml += "<tr>";
						rowHtml += "<td>" + row["MarketName"] + "</td>";
						rowHtml += "<td>" + row["BaseVolume"] + "</td>";
						rowHtml += "<td>" + row["Bid"] + "</td>";
						rowHtml += "<td>" + row["Ask"] + "</td>";
						rowHtml += "<td>" + row["Last"] + "</td>";
						rowHtml += "<td>" + row["PrevDay"] + "</td>";
						rowHtml += "<td>" + row["Change"] + "</td>";
						rowHtml += "<td>" + row["RSI"] + "</td>";
						rowHtml += "</tr>";
					}

					$("#table-body").empty();
					$("#table-body").html(rowHtml);
				}
			}).then(function() {
				isRescan = true;
				setTimeout(update, 30000); // Execute upda
			})
		})();

	</script>
{% endblock %}